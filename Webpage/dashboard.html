<!DOCTYPE html>

<html lang="de">

<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>BlueAirMonitor</title>

    <!-- Script f체r json anfrage und Datepicker-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    <link rel="stylesheet" href="styles.css">
</head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>

<body>


    <div class="Mainmenu">

        <nav id="menu">
            <a href="dashboard.html">Dashboard</a>
            <a href="rooms.html">R채ume</a>
            <a href="createPDF.html">PDF erstellen</a>
        </nav>

    </div>

    <div class="SitemenuDashboard">

        <label for="tempMax">Temperatur max.:</label>
        <input type="number" id="tempMax" maxlength="2" value="35">

        <label for="humMax">Feuchtigkeit max.:</label>
        <input type="number" id="humMax" maxlength="2" value="75">

        <label for="pressureMax">Luftdruck max.:</label>
        <input type="number" id="pressureMax" maxlength="4" value="1000">

        <label for="co2Max">Co2 max.:</label>
        <input type="number" id="co2Max" maxlength="4" value="800" >

        <label for="tempMin">Temperatur min.:</label>
        <input type="number" id="tempMin" maxlength="2" value="18">

        <label for="humMin">Feuchtigkeit min.:</label>
        <input type="number" id="humMin" maxlength="2" value="25">

        <label for="pressureMin">Luftdruck min.:</label>
        <input type="number" id="pressureMin" maxlength="4" value="800">

    </div>

    <hr>

    <div id="Dashboard">

    </div>


    <script>

        $.getJSON('http://localhost/ESP32/getProject.php', function (projects) {

            let array = projects.projects;
            let values = ['Erste Messung:', '', 'Anzahl R채ume:', '', 'aktive Alarme:', '6', 'Letzte Messung:', '', 'Anzahl Ger채te:', '', 'Alarme gesamt:', '12'];

            let selectElement = document.getElementById('selectProject');

            array.forEach(function (project) {
                const projectblock = document.createElement('div');
                projectblock.className = 'Projectblock';
                projectblock.onclick = function () { showDetails(project); };
                document.getElementById('Dashboard').appendChild(projectblock);

                const p = document.createElement('p');
                p.textContent = capitalizeString(project);
                projectblock.appendChild(p);

                const statistics = document.createElement('div');
                statistics.className = 'statistics';
                projectblock.appendChild(statistics);

                $.getJSON('http://localhost/ESP32/getStatistics.php?project=' + project, function (data) {

                    values[1] = data.oldTimestamp;
                    values[3] = data.rooms;
                    values[7] = data.newTimestamp;
                    values[9] = data.devices;

                    values.forEach(text => {
                        const p = document.createElement('p');
                        p.textContent = text;
                        statistics.appendChild(p);
                    })

                });

            });

        });


        function capitalizeString(string) {
            return string[0].toUpperCase() + string.slice(1);
        }

        function showDetails(project) {

            alert('Details');
        }
    </script>


</body>

</html>